@model egdbooking_v2.ViewModels.BookingsViewModel

@{
    if (ViewBag.lang == "fr")
    {
        System.Globalization.CultureInfo ci = new System.Globalization.CultureInfo("fr");
        System.Globalization.CultureInfo.CurrentCulture = ci;
        System.Globalization.CultureInfo.CurrentUICulture = ci;
        Layout = "~/Views/Shared/_WETLayoutFra.cshtml";
    }
    else
    {
        System.Globalization.CultureInfo ci = new System.Globalization.CultureInfo("en");
        System.Globalization.CultureInfo.CurrentCulture = ci;
        System.Globalization.CultureInfo.CurrentUICulture = ci;
        Layout = "~/Views/Shared/_WETLayoutEng.cshtml";
    }
    ViewBag.Title = Resources.BookingsSummary;
    ViewBag.isAdmin = false;//HttpContext.Current.User.IsInRole("Admin")
    ViewBag.isLoggedIn = true;//HttpContext.Current.User.IsInRole("User")
}

@section lastwrite
{
    @System.IO.File.GetLastWriteTime(System.IO.Path.GetFullPath(this.Path.TrimStart(new char[] { '/' }))).ToString(Resources.ShortDate)
}

<h2>@ViewBag.Title</h2>

<ul>
    @foreach (var dock in Model.Docks)
    {
        <li><a href="#@dock.DockName">@dock.DockName</a></li>
    }
</ul>

@foreach (var dock in Model.Docks)
{
    <h2><a name="@dock.DockName"></a>@dock.DockName</h2>

    <table class="table">
        <tr>
            @if (ViewBag.isLoggedIn)
            {
                <th>
                    @Resources.Vessel
                </th>
            }
            <th>
                @Resources.Section
            </th>
            <th>
                @Resources.DockingDates
            </th>
            <th>
                @Resources.BookingDate
            </th>
            @if (ViewBag.isAdmin)
            {
                <th></th>
            }
        </tr>
    @foreach (var item in dock.Bookings) {
        <tr>
            @if (ViewBag.isLoggedIn)
            {
                <td>
                    @Html.DisplayFor(modelItem => item.Vessel.Name)
                </td>
            }
            <td>
                @foreach (var section in item.Sections) { 
                    @Html.DisplayText(section)
                }
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.FormattedStartDate)
                -
                @Html.DisplayFor(modelItem => item.FormattedEndDate)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.FormattedBookingDate)
            </td>
            @if (ViewBag.isAdmin)
            {
                <td>
                    @Html.ActionLink("Edit", "Edit", new { id = item.Id }) |
                    @Html.ActionLink("Details", "Details", new { id = item.Id }) |
                    @Html.ActionLink("Delete", "Delete", new { id = item.Id })
                </td>
            }
        </tr>
    }

    </table>
}
